


<!DOCTYPE html>
<html lang="zh-CN">
<head>
    
    <meta name="author" content="Sally">
    
    <meta name="description" content="SQL : Structured Query Language
12345# æ‰€æœ‰è¡¨çš„ä¿¡æ¯select table status from database_name;# æŸ¥è¯¢åº“ä¸­è¡¨çš„ä¸ªæ•°ï¼Œselect database_name; show tables; select found_rows();">
    
    

    
    
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SQL - è¯­æ³• | senbaisang Â· cooooooooder</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    

    <!-- Javascript -->
    <script src="/js/jquery-2.1.0.min.js"></script>
    <script src="/js/jquery.backstretch.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/headroom.min.js"></script>
    <script src="/js/jquery.headroom.min.js"></script>
    <script src="/js/common.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://senbaisang.github.io" title="senbaisang">senbaisang</a>
            </div>

            <div role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                <p class="navbar-text pull-right">cooooooooder</p>

                <ul class="nav navbar-nav">
                    
                    <li id="nav-index"><a href="/">é¦–é¡µ</a></li>
                    
                    <li id="nav-archives"><a href="/archives">å½’æ¡£</a></li>
                    
                    <li id="nav-tags"><a href="/tags">æ ‡ç­¾</a></li>
                    
                    <li id="nav-categories"><a href="/categories">åˆ†ç±»</a></li>
                    

                    <li><a href="https://github.com/senbaisang" target="_blank">GitHub</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <script>
    var backRoot = "/images/background/";
    var backArray = [ "1.jpg", "2.jpg", "3.jpg", "4.jpg", "5.jpg", "6.jpg", "8.jpg",  ];

    $(function() {
        // page-id...
        var pageId = "2016/07/08/SQL-è¯­æ³•/";
        pageId = pageId.substr(0, pageId.indexOf("/"));
        if(pageId === "") pageId = "index";

        $("#nav-" + pageId).addClass("active");
    });
    </script>


  <article class="post container">
    <div class="well post-body first-post last-post">
        <h1>SQL - è¯­æ³•</h1>

        <div class="time-info">
å‘è¡¨äº:<time datetime="2016-07-08T01:35:18.000Z" itemprop="datePublished">2016-07-08</time>ï¼Œæ›´æ–°äº:<time datetime="2017-08-26T14:04:16.000Z" itemprop="dateModified">2017-08-26</time>ï¼ŒBy <a href="http://senbaisang.github.io" title="Sally">Sally</a>
        </div>

        <div class="post-body-inner">
            <div id="toc" class="toc-article well">
                <strong class="toc-title">å¤§çº²</strong>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#æŸ¥è¯¢è¯­å¥"><span class="toc-number">1.</span> <span class="toc-text">æŸ¥è¯¢è¯­å¥</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ¨¡ç³ŠæŸ¥è¯¢&é€šé…ç¬¦(wildcards)like"><span class="toc-number">2.</span> <span class="toc-text">æ¨¡ç³ŠæŸ¥è¯¢&é€šé…ç¬¦(wildcards)like</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ’å…¥è¯­å¥insert"><span class="toc-number">3.</span> <span class="toc-text">æ’å…¥è¯­å¥insert</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ›´æ–°è¯­å¥update"><span class="toc-number">4.</span> <span class="toc-text">æ›´æ–°è¯­å¥update</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ é™¤è¯­å¥delete"><span class="toc-number">5.</span> <span class="toc-text">åˆ é™¤è¯­å¥delete</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sqlæ³¨å…¥SQL_Injection"><span class="toc-number">6.</span> <span class="toc-text">sqlæ³¨å…¥SQL Injection</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ«åsql_aliases"><span class="toc-number">7.</span> <span class="toc-text">åˆ«åsql aliases</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#è¿æ¥æŸ¥è¯¢join_-_Inner_Join_Left_Join_Right_Join_full_Join"><span class="toc-number">8.</span> <span class="toc-text">è¿æ¥æŸ¥è¯¢join - Inner Join Left Join Right Join full Join</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#è”åˆunion"><span class="toc-number">9.</span> <span class="toc-text">è”åˆunion</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å°†ä¸€å¼ è¡¨çš„æ•°æ®æ‹·è´åˆ°å¦ä¸€å¼ è¡¨orå…¶ä»–æ•°æ®åº“çš„è¡¨ä¸­"><span class="toc-number">10.</span> <span class="toc-text">å°†ä¸€å¼ è¡¨çš„æ•°æ®æ‹·è´åˆ°å¦ä¸€å¼ è¡¨orå…¶ä»–æ•°æ®åº“çš„è¡¨ä¸­</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å°†æ•°æ®æ‹·è´åˆ°ä¸€å¼ æ–°è¡¨ï¼Œæ ¹æ®æ•™ç¨‹ï¼Œä½¿ç”¨select_intoï¼Œä¼šå‡ºé”™ğŸ‘‡"><span class="toc-number">10.1.</span> <span class="toc-text">å°†æ•°æ®æ‹·è´åˆ°ä¸€å¼ æ–°è¡¨ï¼Œæ ¹æ®æ•™ç¨‹ï¼Œä½¿ç”¨select intoï¼Œä¼šå‡ºé”™ğŸ‘‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äºæ˜¯ä¹ï¼Œæœç´¢å¾—å¦‚ä¸‹æ–¹æ³•"><span class="toc-number">10.2.</span> <span class="toc-text">äºæ˜¯ä¹ï¼Œæœç´¢å¾—å¦‚ä¸‹æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å°†æ•°æ®æ‹·è´åˆ°å·²ç»å­˜åœ¨çš„ä¸€å¼ è¡¨ä¸­inesrt_into_select"><span class="toc-number">10.3.</span> <span class="toc-text">å°†æ•°æ®æ‹·è´åˆ°å·²ç»å­˜åœ¨çš„ä¸€å¼ è¡¨ä¸­inesrt into select</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ›å»º/åˆ é™¤æ•°æ®åº“&æ•°æ®è¡¨"><span class="toc-number">11.</span> <span class="toc-text">åˆ›å»º/åˆ é™¤æ•°æ®åº“&æ•°æ®è¡¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åªæ˜¯åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œä¸æ˜¯è¡¨æœ¬èº«truncate"><span class="toc-number">12.</span> <span class="toc-text">åªæ˜¯åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œä¸æ˜¯è¡¨æœ¬èº«truncate</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sqlçº¦æŸ(Constraints)"><span class="toc-number">13.</span> <span class="toc-text">sqlçº¦æŸ(Constraints)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ›å»º/åˆ é™¤ç´¢å¼•index"><span class="toc-number">14.</span> <span class="toc-text">åˆ›å»º/åˆ é™¤ç´¢å¼•index</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ä¿®æ”¹è¡¨alter"><span class="toc-number">15.</span> <span class="toc-text">ä¿®æ”¹è¡¨alter</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åˆ›å»ºè§†å›¾View"><span class="toc-number">16.</span> <span class="toc-text">åˆ›å»ºè§†å›¾View</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL_Function"><span class="toc-number">17.</span> <span class="toc-text">SQL Function</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL_Aggregate_Function"><span class="toc-number">17.1.</span> <span class="toc-text">SQL Aggregate Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL_Scalar_Function"><span class="toc-number">17.2.</span> <span class="toc-text">SQL Scalar Function</span></a></li></ol></li></ol>
            </div>

            <p>SQL : Structured Query Language</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æ‰€æœ‰è¡¨çš„ä¿¡æ¯</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">table</span> <span class="keyword">status</span> <span class="keyword">from</span> database_name;</span></span><br><span class="line"># æŸ¥è¯¢åº“ä¸­è¡¨çš„ä¸ªæ•°ï¼Œ</span><br><span class="line"><span class="operator"><span class="keyword">select</span> database_name;</span> <span class="operator"><span class="keyword">show</span> <span class="keyword">tables</span>;</span> <span class="operator"><span class="keyword">select</span> <span class="keyword">found_rows</span>();</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="string">'database_name'</span>;</span></span><br></pre></td></tr></table></figure>
<h1 id="æŸ¥è¯¢è¯­å¥">æŸ¥è¯¢è¯­å¥</h1><ul>
<li>æŸ¥è¯¢æŒ‡å®šåˆ—<code>select</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> column_name, column_name <span class="keyword">from</span> table_name;</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> table_name;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥è¯¢ä¸é‡å¤çš„å€¼<code>distinct</code></li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select <span class="keyword">distinct</span> column_name, column_name <span class="keyword">from</span> table_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„<code>where</code></li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">select column_name, column_name from table_name where colomn_name operator value<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"># operator</span><br><span class="line"><span class="escape">`=</span><span class="escape">` </span><span class="escape">`&lt;</span>&gt;<span class="escape">` </span><span class="escape">`&gt;</span><span class="escape">` </span><span class="escape">`&lt;</span><span class="escape">` </span><span class="escape">`&gt;</span>=<span class="escape">` </span><span class="escape">`&lt;</span>=<span class="escape">` </span><span class="escape">`b</span>etween<span class="escape">` </span><span class="escape">`l</span>ike<span class="escape">` </span><span class="escape">`i</span>n<span class="escape">` </span><span class="escape">`o</span>r<span class="escape">` </span><span class="escape">`a</span>nd<span class="escape">` </span><span class="escape">`l</span>ike<span class="escape">`</span><br><span class="line"></span></span><br><span class="line"><span class="label"># operator :</span> <span class="literal">and</span> | <span class="literal">or</span></span><br><span class="line">select column_name from table_name where condition <span class="literal">and</span> (condition <span class="literal">or</span> condition)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="label"># operator :</span> in</span><br><span class="line">select column_name from table_name where column in (value1, value2, value3)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="label"># operator :</span> between</span><br><span class="line">select column_name from table_name where column_name between value1 <span class="literal">and</span> value2<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹æŸ¥è¯¢ç»“æœæ’åº<code>order by</code> : asc|desc</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> column_name, column_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">asc</span>|<span class="keyword">desc</span>, column_name <span class="keyword">asc</span>|<span class="keyword">desc</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥è¯¢(è¿”å›)æŒ‡å®šæ•°é‡çš„ç»“æœ</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Sql Server / Access</span><br><span class="line"><span class="operator"><span class="keyword">select</span> top <span class="built_in">number</span>|<span class="keyword">percent</span> column_name <span class="keyword">from</span> <span class="keyword">table</span>;</span></span><br><span class="line"></span><br><span class="line"># MySql</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">limit</span> <span class="built_in">number</span>;</span></span><br><span class="line"></span><br><span class="line"># Oracle</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">where</span> cownum &lt;= <span class="built_in">number</span>;</span></span><br></pre></td></tr></table></figure>
<h1 id="æ¨¡ç³ŠæŸ¥è¯¢&amp;é€šé…ç¬¦(wildcards)like">æ¨¡ç³ŠæŸ¥è¯¢&amp;é€šé…ç¬¦(wildcards)<code>like</code></h1><ul>
<li>% åŒ¹é…0ä¸ªè´§å¤šä¸ªå­—ç¬¦</li>
<li>_ åŒ¹é…1ä¸ªå­—ç¬¦</li>
<li>[charlist] åŒ¹é…é›†åˆ</li>
<li>[^charlist] or [!charlist]</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> table_name <span class="keyword">where</span> column_name <span class="keyword">like</span> pattern;</span></span><br></pre></td></tr></table></figure>
<h1 id="æ’å…¥è¯­å¥insert">æ’å…¥è¯­å¥<code>insert</code></h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> table_name <span class="keyword">values</span>(value1, value2, value3);</span></span><br><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> table_name (column1, column2, column3) <span class="keyword">values</span> (value1, value2, value3);</span></span><br></pre></td></tr></table></figure>
<h1 id="æ›´æ–°è¯­å¥update">æ›´æ–°è¯­å¥<code>update</code></h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">update</span> table_name <span class="keyword">set</span> column1=value1, column2=value2 <span class="keyword">where</span> some_column=some_value;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>the where clause specifies which record or records that should be updated. if you omit the where clause, all records will be updated!</p>
</blockquote>
<h1 id="åˆ é™¤è¯­å¥delete">åˆ é™¤è¯­å¥<code>delete</code></h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">delete</span> <span class="keyword">from</span> table_name <span class="keyword">where</span> some_column = some_value;</span></span><br><span class="line"></span><br><span class="line"># <span class="operator"><span class="keyword">delete</span> all <span class="keyword">data</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name;</span></span><br><span class="line"><span class="operator"><span class="keyword">delete</span> * <span class="keyword">from</span> table_name;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>the where clause specifies which record or records that should be updated. if you omit the where clause, all records will be updated!</p>
</blockquote>
<h1 id="sqlæ³¨å…¥SQL_Injection">sqlæ³¨å…¥<code>SQL Injection</code></h1><ul>
<li>SQL Injection based on 1=1 is always true</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> table_name <span class="keyword">where</span> some_column = some_value <span class="keyword">or</span> <span class="number">1</span> = <span class="number">1</span>;</span></span><br><span class="line"></span><br><span class="line"># 1 = 1 | "" = "" are always true</span><br><span class="line">eg: <span class="operator"><span class="keyword">select</span> user_name, <span class="keyword">password</span> <span class="keyword">from</span> <span class="keyword">Users</span> <span class="keyword">where</span> user_id = <span class="number">11</span> <span class="keyword">or</span> <span class="number">1</span> = <span class="number">1</span>;</span></span><br><span class="line">eg: <span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">Users</span> <span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">""</span> <span class="keyword">or</span> <span class="string">""</span> = <span class="string">""</span> <span class="keyword">and</span> <span class="keyword">password</span> = <span class="string">""</span> <span class="keyword">or</span> <span class="string">""</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>SQL Injection based on batched SQL statements (æ‰¹å¤„ç†sqlè¯­å¥ï¼Œåˆ†å·åˆ†éš”)</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">textUserId = getRequestString(<span class="string">"UserId"</span>);</span><br><span class="line">textSQL = <span class="string">"select * from Users where UserId = "</span> + textUserId;</span><br><span class="line">eg: <span class="keyword">if</span> textUserId = 11; <span class="keyword">drop</span> <span class="keyword">table</span> table_name;</span><br><span class="line">sql = select * from Users where UserId = 11; <span class="keyword">drop</span> <span class="keyword">table</span> table_name;</span><br></pre></td></tr></table></figure>
<h1 id="åˆ«åsql_aliases">åˆ«å<code>sql aliases</code></h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># å­—æ®µåˆ«å</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">as</span> alias_name <span class="keyword">from</span> table_name;</span></span><br><span class="line"></span><br><span class="line"># è¡¨åˆ«å</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">as</span> alias_name;</span></span><br><span class="line"></span><br><span class="line"># å­—æ®µåˆ«ådemo</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">as</span> a, column_name <span class="keyword">as</span> b <span class="keyword">from</span> table_name;</span></span><br><span class="line"></span><br><span class="line"># å°†å‡ ä¸ªå­—æ®µåˆèµ·æ¥ä½¿ç”¨åˆ«å</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name, column_name + <span class="string">','</span> + column_name + <span class="string">','</span> + column_name <span class="keyword">as</span> alias_name <span class="keyword">from</span> table_name;</span></span><br><span class="line"># è¿™ä¸ªåŠŸèƒ½åœ¨mysqlä¸­ï¼Œéœ€è¦ç”¨å…³é”®å­—`concat`</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name, <span class="keyword">concat</span>(column_name, <span class="string">','</span>, column_name, <span class="string">','</span>, column_name) <span class="keyword">as</span> alias_name <span class="keyword">from</span> table_name;</span></span><br><span class="line"></span><br><span class="line"># è¡¨åˆ«ådemo</span><br><span class="line"><span class="operator"><span class="keyword">select</span> a.<span class="keyword">id</span>, a.<span class="keyword">name</span>, b.score <span class="keyword">from</span> A_table <span class="keyword">as</span> a, B_table <span class="keyword">as</span> b <span class="keyword">where</span> a.<span class="keyword">id</span> = b.<span class="keyword">id</span>;</span></span><br></pre></td></tr></table></figure>
<p>aliases can be useful when:</p>
<ul>
<li>There are more than one table involved in a query</li>
<li>Functions are used in the query</li>
<li>Column names are big or not very readable</li>
<li>Two or more columns are combined together</li>
</ul>
<h1 id="è¿æ¥æŸ¥è¯¢join_-_Inner_Join_Left_Join_Right_Join_full_Join">è¿æ¥æŸ¥è¯¢<code>join</code> - <code>Inner Join</code> <code>Left Join</code> <code>Right Join</code> <code>full Join</code></h1><ul>
<li>Inner Join : returns all rows when there is at least one match in both tables</li>
<li>Left  Join : return all rows from the left table, and the mached rows from the right table</li>
<li>Right Join : return all rows from the right table, and the mached rows from the left table</li>
<li>Full  Join : return all rows when there is a match in one of the tables</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Inner Join</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table1 <span class="keyword">inner</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> table1.column_name = table2.column_name;</span></span><br><span class="line"></span><br><span class="line"># Left Join</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table1 <span class="keyword">left</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> table1.column_name = table2.column_name;</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> table1.column_name = table2.column_name;</span></span><br><span class="line"></span><br><span class="line"># Right Join</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table1 <span class="keyword">right</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> table1.column_name = table2.column_name;</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table1 <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> table1.column_name = table2.column_name;</span></span><br><span class="line"></span><br><span class="line"># Full Join</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table1 <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> table1.column_name = table2.column_name;</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/img_innerjoin.gif" style="margin-left:2em;"> <img src="/images/img_leftjoin.gif" style="margin-left:2em;"> <img src="/images/img_rightjoin.gif" style="margin-left:2em;"> <img src="/images/img_fulljoin.gif" style="margin-left:2em;"></p>
<h1 id="è”åˆunion">è”åˆ<code>union</code></h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select column_name from table1 <span class="class"><span class="keyword">union</span> <span class="title">select</span> <span class="title">column_name</span> <span class="title">from</span> <span class="title">table2</span>;</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹ï¼ŒunionæŸ¥è¯¢çš„æ•°æ®æ˜¯å»é‡å¤çš„(distinct)ï¼Œä½¿ç”¨union allå¯ä»¥æŸ¥è¯¢æ‰€æœ‰(åŒ…æ‹¬é‡å¤æ•°æ®)</span></span><br><span class="line">select column_name from table1 <span class="class"><span class="keyword">union</span> <span class="title">all</span> <span class="title">select</span> <span class="title">column_name</span> <span class="title">from</span> <span class="title">table2</span>;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>notice that each select statement within the union must have the same number of columns.<br>the columns must also have similar data types.<br>also, the columns in each select statement must be in the same order.</p>
</blockquote>
<h1 id="å°†ä¸€å¼ è¡¨çš„æ•°æ®æ‹·è´åˆ°å¦ä¸€å¼ è¡¨orå…¶ä»–æ•°æ®åº“çš„è¡¨ä¸­">å°†ä¸€å¼ è¡¨çš„æ•°æ®æ‹·è´åˆ°å¦ä¸€å¼ è¡¨orå…¶ä»–æ•°æ®åº“çš„è¡¨ä¸­</h1><h2 id="å°†æ•°æ®æ‹·è´åˆ°ä¸€å¼ æ–°è¡¨ï¼Œæ ¹æ®æ•™ç¨‹ï¼Œä½¿ç”¨select_intoï¼Œä¼šå‡ºé”™ğŸ‘‡">å°†æ•°æ®æ‹·è´åˆ°ä¸€å¼ æ–°è¡¨ï¼Œæ ¹æ®æ•™ç¨‹ï¼Œä½¿ç”¨<code>select into</code>ï¼Œä¼šå‡ºé”™ğŸ‘‡</h2><p>the select int statement copies data from one table and insert it into a new table.</p>
<p> <strong>ä¼šæŠ¥é”™ï¼š<code>ERROR 1327 (42000): Undeclared variable: apn_devices_backup</code> (apn_devices_backupæ˜¯æ–°çš„è¡¨å)</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">into</span> new_table [<span class="keyword">in</span> externaldb] <span class="keyword">from</span> table1;</span></span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">into</span> new_table [<span class="keyword">in</span> externaldb] <span class="keyword">from</span> table1;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>the new table will be created with the column_names and types as defined in the select statement. you can apply new names using the as clause.</p>
</blockquote>
<ul>
<li>demo</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºä¸€å¼ è¡¨çš„å‰¯æœ¬</span><br><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">into</span> UsersBackup <span class="keyword">from</span> <span class="keyword">Users</span>;</span></span><br><span class="line"></span><br><span class="line"># å°†ä¸€å¼ è¡¨æ‹·è´åˆ°å¦ä¸ªæ•°æ®åº“çš„è¡¨ä¸­</span><br><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">into</span> UsersBackup <span class="keyword">in</span> <span class="string">'Backup.mdb'</span> <span class="keyword">from</span> <span class="keyword">Users</span>;</span></span><br><span class="line"></span><br><span class="line"># åªæ‹·è´ä¸ªåˆ«å­—æ®µåˆ°æ–°çš„è¡¨ä¸­</span><br><span class="line"><span class="operator"><span class="keyword">select</span> UserId, UserName, UserPassword <span class="keyword">into</span> UsersBackup <span class="keyword">from</span> <span class="keyword">Users</span>;</span></span><br><span class="line"></span><br><span class="line"># æ‹·è´ç¬¦åˆæ¡ä»¶çš„æ•°æ®åˆ°æ–°è¡¨</span><br><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">into</span> UsersBackup <span class="keyword">from</span> <span class="keyword">Users</span> <span class="keyword">where</span> <span class="keyword">id</span> &gt; <span class="number">100</span>;</span></span><br><span class="line"></span><br><span class="line"># æ‹·è´å¤šå¼ è¡¨çš„æ•°æ®åˆ°ä¸€å¼ æ–°è¡¨</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">Users</span>.UserName, <span class="keyword">Class</span>.ClassName <span class="keyword">into</span> UserClassBackup <span class="keyword">from</span> <span class="keyword">Users</span> <span class="keyword">left</span> <span class="keyword">join</span> <span class="keyword">Class</span> <span class="keyword">on</span> <span class="keyword">Users</span>.<span class="keyword">id</span> = <span class="keyword">Class</span>.UserId;</span></span><br><span class="line"></span><br><span class="line"># <span class="operator"><span class="keyword">select</span> <span class="keyword">into</span> è¯­å¥å¯ä»¥åˆ›å»ºä¸€å¼ ç›¸åŒæ¨¡å¼çš„æ–°çš„ç©ºè¡¨ï¼Œåªè¦æŸ¥è¯¢è¯­å¥è¿”å›ç©ºå³å¯</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">into</span> new_table <span class="keyword">from</span> table1 <span class="keyword">where</span> <span class="number">1</span> = <span class="number">0</span>;</span></span><br></pre></td></tr></table></figure>
<h2 id="äºæ˜¯ä¹ï¼Œæœç´¢å¾—å¦‚ä¸‹æ–¹æ³•">äºæ˜¯ä¹ï¼Œæœç´¢å¾—å¦‚ä¸‹æ–¹æ³•</h2><p><a href="http://stackoverflow.com/questions/16809393/select-into-in-mysql" target="_blank" rel="external">è§£å†³æ–¹æ³•</a>ï¼Œè™½ç„¶å…³é”®å­—select intoä¸å¯ç”¨ï¼Œä½†æ˜¯ä»¥ä¸Šdemoçš„ä¾‹å­è¿˜æ˜¯æˆç«‹çš„ã€‚æ›¿æ¢å…³é”®å­—å³å¯ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æ–¹æ³•1</span><br><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">table</span> new_table <span class="keyword">select</span> * <span class="keyword">from</span> origin_table;</span></span><br></pre></td></tr></table></figure>
<h2 id="å°†æ•°æ®æ‹·è´åˆ°å·²ç»å­˜åœ¨çš„ä¸€å¼ è¡¨ä¸­inesrt_into_select">å°†æ•°æ®æ‹·è´åˆ°å·²ç»å­˜åœ¨çš„ä¸€å¼ è¡¨ä¸­<code>inesrt into select</code></h2><p>the insert into select statement copies data from one table and inserts it into   an existing table. any existing rows in the target table are unaffected.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> table2 <span class="keyword">select</span> * <span class="keyword">from</span> table1;</span></span><br><span class="line"><span class="operator"><span class="keyword">insert</span> <span class="keyword">into</span> table2 (column_name, column_name...) <span class="keyword">select</span> column_name, column_name ... <span class="keyword">from</span> table1 [<span class="keyword">where</span> condition];</span></span><br></pre></td></tr></table></figure>
<h1 id="åˆ›å»º/åˆ é™¤æ•°æ®åº“&amp;æ•°æ®è¡¨">åˆ›å»º/åˆ é™¤æ•°æ®åº“&amp;æ•°æ®è¡¨</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># database</span><br><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">database</span> dbname;</span></span><br><span class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">database</span> dbname;</span></span><br><span class="line"></span><br><span class="line"># table</span><br><span class="line"><span class="operator"><span class="keyword">create</span> tablle table_name (</span><br><span class="line">  column_name1 data_type(<span class="keyword">size</span>),</span><br><span class="line">  column_name2 data_type(<span class="keyword">size</span>),</span><br><span class="line">  column_name3 data_type(<span class="keyword">size</span>),</span><br><span class="line">);</span></span><br><span class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span> table_name;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ•°æ®ç±»å‹çœ‹<a href="http://www.w3schools.com/sql/sql_datatypes.asp" target="_blank" rel="external">è¿™é‡Œ</a></li>
</ul>
<h1 id="åªæ˜¯åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œä¸æ˜¯è¡¨æœ¬èº«truncate">åªæ˜¯åˆ é™¤è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œä¸æ˜¯è¡¨æœ¬èº«<code>truncate</code></h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">truncate</span> <span class="keyword">table</span> table_name;</span></span><br></pre></td></tr></table></figure>
<h1 id="sqlçº¦æŸ(Constraints)">sqlçº¦æŸ(Constraints)</h1><p>constraints can be specified when the table is created (inside the create table statement) or after the table is created (inside the alter table statement).</p>
<ul>
<li>not null : indicates that a column cannot store null value</li>
<li>unique   : ensures that each row for a column must have a unique value</li>
<li>primary key : a combination of a not null and unique. ensures that a column (or combination of two or more columns) have a unique identity which helps to find a particular record in a table more easily and quickly</li>
<li>foreign key : ensure the referential integrity of the data in one table to match values in another table</li>
<li>check    : ensures that the value in a column meets a specific condition</li>
<li>default  : specifies a default value for a column</li>
<li>auto increment</li>
</ul>
<blockquote>
<p>note that you can have more unique constraints per table, but only one primary key constraint per table</p>
</blockquote>
<ul>
<li>åˆ›å»ºè¡¨æ—¶æ·»åŠ çº¦æŸ SQL unique constraint on create table</li>
</ul>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># SQL Server/ Oracle / Access</span></span><br><span class="line">create table table_name (</span><br><span class="line">  _id <span class="built_in">int</span> <span class="literal">not</span> <span class="literal">null</span>  unique  primary key,   <span class="preprocessor">#=&gt; éç©ºï¼Œå”¯ä¸€ï¼Œä¸»é”®</span></span><br><span class="line">  firstName varchar(<span class="number">255</span>),</span><br><span class="line">  lastName varchar(<span class="number">255</span>) <span class="literal">not</span> <span class="literal">null</span>,</span><br><span class="line">  other_id <span class="built_in">int</span> foreign key references Other_table(_id)  <span class="preprocessor">#=&gt; å¤–é”®</span></span><br><span class="line">)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># MySql</span></span><br><span class="line">create table table_name (</span><br><span class="line">  _id <span class="built_in">int</span> <span class="literal">not</span> <span class="literal">null</span><span class="comment">;                #=&gt;  éç©ºï¼Œä¸»é”®</span></span><br><span class="line">  firstName varchar(<span class="number">255</span>),</span><br><span class="line">  lastName varchar(<span class="number">255</span>) <span class="literal">not</span> <span class="literal">null</span>,</span><br><span class="line">  other_id <span class="built_in">int</span>,                    <span class="preprocessor">#=&gt;  å¤–é”®</span></span><br><span class="line">  unique (_id),                    <span class="preprocessor">#=&gt;  å”¯ä¸€</span></span><br><span class="line">  primary key (_id),               <span class="preprocessor">#=&gt;  ä¸»é”®</span></span><br><span class="line">  foreign key (other_id) references Other_table(_id)    <span class="preprocessor">#=&gt; å¤–é”®</span></span><br><span class="line">)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># å¤šä¸ªåˆ—ä½¿ç”¨å”¯ä¸€çº¦æŸ MySql/ SQL Server/ Oracle/ Access</span></span><br><span class="line">create table table_name (</span><br><span class="line">  _id <span class="built_in">int</span> <span class="literal">not</span> <span class="literal">null</span><span class="comment">;</span></span><br><span class="line">  firstName varchar(<span class="number">255</span>),</span><br><span class="line">  lastName varchar(<span class="number">255</span>) <span class="literal">not</span> <span class="literal">null</span>,</span><br><span class="line">  constraint uc_id unique (_id, lastName)     <span class="preprocessor">#=&gt; éç©º</span></span><br><span class="line">  constraint pk_table primary key (_id, lastname)  <span class="preprocessor">#=&gt; ä¸»é”® there is only one primary key (pk_table), however, the value of the primary key is made up of two columns(_id + lastName)</span></span><br><span class="line">  constraint fk_table foreign key (other_id) references Other_table(_id)  <span class="preprocessor">#=&gt; å¤–é”®</span></span><br><span class="line">)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹è¡¨æ—¶æ·»åŠ çº¦æŸ SQL unique constraint on alert table</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">add</span> <span class="keyword">unique</span> (_id);</span> | <span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">add</span> primary <span class="keyword">key</span> (_id);</span></span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">add</span> <span class="keyword">constraint</span> uc_id <span class="keyword">unique</span> (_id, lastName);</span> | <span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">add</span> <span class="keyword">constraint</span> pk_id primary (_id, lastName);</span></span><br></pre></td></tr></table></figure>
<ul>
<li>åˆ é™¤çº¦æŸ</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># MySql</span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">drop</span> <span class="keyword">index</span> uc_id;</span> | <span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">drop</span> primary <span class="keyword">key</span>;</span> | <span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span>  Persons <span class="keyword">drop</span> foreign <span class="keyword">key</span> fk_table;</span></span><br><span class="line"></span><br><span class="line"># SQL Server/ Oracle/ Access</span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">drop</span> <span class="keyword">constraint</span> uc_id;</span> | <span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">drop</span> <span class="keyword">constraint</span> pk_table;</span> | <span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span> Persons <span class="keyword">drop</span> <span class="keyword">constraint</span> fk_table;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>check çº¦æŸ</li>
</ul>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MySql</span></span><br><span class="line">create table Persons<span class="function"> (</span></span><br><span class="line">  _id<span class="instruction"> int </span>not null,</span><br><span class="line"> <span class="instruction"> check </span>(_id &gt; 0<span class="function">)</span></span><br><span class="line"><span class="function">)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sql Server/ Oracle /Access</span></span><br><span class="line">create table Persons<span class="function"> (</span></span><br><span class="line">  _id<span class="instruction"> int </span>not null<span class="instruction"> check </span>(_id &gt; 0<span class="function">)</span>,</span><br><span class="line"><span class="function">)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># checkä½œç”¨åœ¨å¤šä¸ªåˆ—</span></span><br><span class="line">create table Persons<span class="function"> (</span></span><br><span class="line">  _id<span class="instruction"> int </span>not null,</span><br><span class="line">  lastName<span class="function"> varchar(</span>255<span class="function">)</span>,</span><br><span class="line">  sex int,</span><br><span class="line">  constraint chk_person<span class="instruction"> check </span>(_id &gt; 0<span class="instruction"> and </span>sex &gt; 18<span class="function">)</span></span><br><span class="line"><span class="function">)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¡¨æ—¶æ·»åŠ check</span></span><br><span class="line">alter table Persons<span class="instruction"> add </span>check<span class="function"> (</span>_id &gt; 0<span class="function">)</span>;</span><br><span class="line">alter table Persons<span class="instruction"> add </span>constraint chk_person<span class="instruction"> check </span>(_id &gt; 0<span class="instruction"> and </span>sex &gt; 18<span class="function">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤checkçº¦æŸ</span></span><br><span class="line">alter table Persons drop<span class="instruction"> check </span>chk_person;  <span class="comment">#=&gt; mysql</span></span><br><span class="line">alter table Persons drop constraint chk_person; <span class="comment">#=&gt; sql server/ oracle / access</span></span><br></pre></td></tr></table></figure>
<h1 id="åˆ›å»º/åˆ é™¤ç´¢å¼•index">åˆ›å»º/åˆ é™¤ç´¢å¼•<code>index</code></h1><p>updating a table with indexes takes more time than updating a table without(because the indexes also need to update).</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="built_in">create</span> index index_name <span class="command"><span class="keyword">on</span> <span class="title">table_name</span> (<span class="title">column_name</span>);</span></span><br><span class="line"><span class="built_in">create</span> unique index index_name <span class="command"><span class="keyword">on</span> <span class="title">table_name</span> (<span class="title">column_name</span>);</span></span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line"><span class="built_in">create</span> index PIndex <span class="command"><span class="keyword">on</span> <span class="title">Persons</span> (<span class="title">lastName</span>);</span></span><br><span class="line"><span class="built_in">create</span> index PIndex <span class="command"><span class="keyword">on</span> <span class="title">Persons</span> (<span class="title">lastName</span>, <span class="title">FirstName</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ç´¢å¼•</span></span><br><span class="line">drop index index_name <span class="command"><span class="keyword">on</span> <span class="title">table_name</span>;    #=&gt; <span class="title">access</span></span></span><br><span class="line">drop index table_name.index_name;       <span class="comment">#=&gt; sql server</span></span><br><span class="line">drop index index_name;                  <span class="comment">#=&gt; db2/oracle</span></span><br><span class="line">alter table table_name drop index index_name;  <span class="comment">#=&gt; mysql</span></span><br></pre></td></tr></table></figure>
<h1 id="ä¿®æ”¹è¡¨alter">ä¿®æ”¹è¡¨<code>alter</code></h1><ul>
<li>add a column in a table</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">add</span> <span class="keyword">column</span> datatype;</span></span><br><span class="line"></span><br><span class="line"># sql server/ access</span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">alter</span> <span class="keyword">column</span> column_name datatype;</span></span><br><span class="line"></span><br><span class="line"># mysql / oracle(prior version 10G)</span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">modify</span> <span class="keyword">column</span> column_name datatype;</span></span><br><span class="line"></span><br><span class="line"># oracle 10G and later</span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">modify</span> column_name datatype;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>delete a column in a table (notice that some database systems donâ€™t allow deleting a column)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> table_name <span class="keyword">drop</span> <span class="keyword">column</span> column_name;</span></span><br><span class="line"></span><br><span class="line">eg:</span><br><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">drop</span> <span class="keyword">column</span> DateOfBirth;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>change data type</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> Persons <span class="keyword">alter</span> <span class="keyword">column</span> DateOfBirth <span class="keyword">year</span>;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>notice that the â€˜DateOfBirthâ€™ column is now of type year and is going to hold a year in a two-digit or four-digit format column is now of type year and is going to hold a year in a two-digit or four-digit format.</p>
</blockquote>
<h1 id="åˆ›å»ºè§†å›¾View">åˆ›å»ºè§†å›¾<code>View</code></h1><p>a view is a virtual table.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºè§†å›¾</span><br><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">view</span> view_name <span class="keyword">as</span> <span class="keyword">select</span> column_name(s) <span class="keyword">from</span> table_name <span class="keyword">where</span> condition;</span></span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹è§†å›¾</span><br><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> view_name <span class="keyword">where</span> condition;</span></span><br><span class="line"></span><br><span class="line"># æ›´æ–°è§†å›¾</span><br><span class="line"><span class="operator"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> view_name <span class="keyword">as</span> <span class="keyword">select</span> column_name(s) <span class="keyword">from</span> table_name <span class="keyword">where</span> condition;</span></span><br><span class="line"></span><br><span class="line"># åˆ é™¤è§†å›¾</span><br><span class="line"><span class="operator"><span class="keyword">drop</span> <span class="keyword">view</span> view_name;</span></span><br></pre></td></tr></table></figure>
<h1 id="SQL_Function">SQL Function</h1><h2 id="SQL_Aggregate_Function">SQL Aggregate Function</h2><ul>
<li>avg()   : returns ths average value</li>
<li>count() : returns the number of rows</li>
<li>first() : returns the first value</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># access</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">first</span>(column_name) <span class="keyword">from</span> table_name;</span></span><br><span class="line"></span><br><span class="line"># sql server</span><br><span class="line"><span class="operator"><span class="keyword">select</span> top <span class="number">1</span> column_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">asc</span>;</span></span><br><span class="line"></span><br><span class="line"># mysql</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">asc</span> <span class="keyword">limit</span> <span class="number">1</span>;</span></span><br><span class="line"></span><br><span class="line"># oracle</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">asc</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>last()  : returns the last value</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># access</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">last</span>(column_name) <span class="keyword">from</span> table_name;</span></span><br><span class="line"></span><br><span class="line"># sql server</span><br><span class="line"><span class="operator"><span class="keyword">select</span> top <span class="number">1</span> column_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">desc</span>;</span></span><br><span class="line"></span><br><span class="line"># mysql</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">1</span>;</span></span><br><span class="line"></span><br><span class="line"># oracle</span><br><span class="line"><span class="operator"><span class="keyword">select</span> column_name <span class="keyword">from</span> table_name <span class="keyword">order</span> <span class="keyword">by</span> column_name <span class="keyword">desc</span> <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">1</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>max()   : returns the larget value</li>
<li>min()   : returns the smallest value</li>
<li>sum()   : returns the sum</li>
<li>group by</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> column_name, <span class="keyword">sum</span>(column_name) <span class="keyword">from</span> table_name <span class="keyword">group</span> <span class="keyword">by</span> column_name;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>having : the having clause was added to SQL because the where keyword cloud not be used with aggregate functions</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> column_name, aggregate_function(column_name) <span class="keyword">from</span> table_name <span class="keyword">where</span> column_name operate <span class="keyword">value</span> <span class="keyword">group</span> <span class="keyword">by</span> column_name <span class="keyword">having</span> aggregate_function(column_name) operate <span class="keyword">value</span>;</span></span><br></pre></td></tr></table></figure>
<h2 id="SQL_Scalar_Function">SQL Scalar Function</h2><ul>
<li>ucase() : converts a field to upper case</li>
<li>lcase() : converts a field to lower case</li>
<li>mid()   : extract characters from a text field</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">mid</span>(column_name, <span class="keyword">start</span>, <span class="keyword">length</span>) <span class="keyword">as</span> some_name <span class="keyword">from</span> table_name;</span></span><br><span class="line">- column_name : required. the field to extract characters from</span><br><span class="line">- <span class="operator"><span class="keyword">start</span>       : <span class="keyword">required</span>. specifies the <span class="keyword">starting</span> <span class="keyword">position</span> (<span class="keyword">start</span> <span class="keyword">at</span> <span class="number">1</span>)</span><br><span class="line">- <span class="keyword">length</span>      : optional. the <span class="built_in">number</span> <span class="keyword">of</span> <span class="keyword">characters</span> <span class="keyword">to</span> <span class="keyword">return</span>. <span class="keyword">if</span> omitted, the <span class="keyword">mid</span>() <span class="keyword">function</span> <span class="keyword">returns</span> the rest <span class="keyword">of</span> the <span class="built_in">text</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>len()   : returns the length of a text field</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">len</span>(column_name) <span class="keyword">from</span> table_name;</span></span><br><span class="line"># æ³¨æ„ï¼Œåœ¨mysqlä¸­æ˜¯length()å‡½æ•°</span><br><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">length</span>(column_name) <span class="keyword">from</span> table_name;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>round() : rounds a numeric field to the number of decimals specified</li>
<li>now()   : returns the current system date and time</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> column_name, <span class="keyword">now</span>() <span class="keyword">from</span> table_name;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>format(): formats how a field is to be displayed</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">format</span>(column_name, <span class="keyword">format</span>) <span class="keyword">from</span> table_name;</span></span><br></pre></td></tr></table></figure>


			
            <section class="comment">
<!-- å¤šè¯´è¯„è®ºæ¡† start -->
<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->
</section>




        </div>
    </div>
</article>


    <footer id="footer">
    <div id="bottom-tip">
        senbaisang â€”â€” <small>cooooooooder</small>
    </div>
        <small>è¯¥åšå®¢ç”± <a href="https://hexo.io/" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ï¼Œæ­è½½ <a href="https://github.com/XadillaX/hexadillax" target="_blank">Hexadillax</a> ä¸»é¢˜</small><br />
        <small>&copy; 2015 Sally</small>
    </footer>

    


</body>
</html>


